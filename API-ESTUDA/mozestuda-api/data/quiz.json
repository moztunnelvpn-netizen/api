// No seu server.js - ATUALIZE a rota de perguntas
app.get("/api/quiz/perguntas", async (req, res) => {
  try {
    const { materia, nivel, limit = 10 } = req.query;
    const quizData = await readJson("./data/quiz.json");
    
    let perguntas = [...quizData.perguntas];
    
    // Aplicar filtros
    if (materia) {
      perguntas = perguntas.filter(p => 
        p.materia.toLowerCase() === materia.toLowerCase()
      );
    }
    
    if (nivel) {
      perguntas = perguntas.filter(p => 
        p.nivel.toLowerCase() === nivel.toLowerCase()
      );
    }
    
    // âœ… EMBARALHAR PERGUNTAS ALEATORIAMENTE
    perguntas = perguntas.sort(() => Math.random() - 0.5);
    
    // Limitar quantidade
    perguntas = perguntas.slice(0, parseInt(limit));
    
    // Remover resposta correta para o cliente
    const perguntasParaCliente = perguntas.map(p => {
      const { respostaCorreta, ...perguntaSemResposta } = p;
      return perguntaSemResposta;
    });
    
    res.json({
      success: true,
      data: perguntasParaCliente,
      total: perguntasParaCliente.length
    });
    
  } catch (error) {
    res.status(500).json({ 
      success: false, 
      error: "Erro ao buscar perguntas do quiz" 
    });
  }
});
